# Geniideas-Vue å°ˆæ¡ˆæŠ€è¡“æ¶æ§‹

## ğŸ“Š æ•´é«”æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (Frontend)                     â”‚
â”‚            Vue 3 + Vite + JavaScript + SCSS              â”‚
â”‚                    Port: é–‹ç™¼ç’°å¢ƒ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP / REST API
                     â”‚ (CORS enabled)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¾Œç«¯ (Backend)                         â”‚
â”‚                Node.js + Express.js                      â”‚
â”‚                   Port: 3001                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è³‡æ–™åº« (Database)                       â”‚
â”‚              SQLite 3 (better-sqlite3)                   â”‚
â”‚              File: flowcharts.db                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ å‰ç«¯æŠ€è¡“ç·š (Frontend)

### æ ¸å¿ƒæ¡†æ¶
- **Vue 3** (v3.4.0) - æ¼¸é€²å¼ JavaScript æ¡†æ¶
- **Vite** (v5.0.0) - æ–°ä¸–ä»£å‰ç«¯å»ºæ§‹å·¥å…·
- **JavaScript (ES6+)** - ç´” JavaScriptï¼Œæœªä½¿ç”¨ TypeScript

### UI ç›¸é—œ
- **SCSS/Sass** (v1.93.2) - CSS é è™•ç†å™¨
- **Vue Zoomable** (v1.2.8) - ç•«å¸ƒç¸®æ”¾åŠŸèƒ½
- è‡ªå®šç¾©çµ„ä»¶ç³»çµ±ï¼ˆå¡ç‰‡ã€é€£æ¥ç·šç­‰ï¼‰

### æ•¸æ“šè™•ç† & å°å‡º
- **ExcelJS** (v4.4.0) - Excel æ–‡ä»¶è™•ç†ï¼ˆå°å‡º Hierarchyï¼‰
- **XLSX** (v0.18.5) - Excel æ–‡ä»¶è®€å¯«
- **jsPDF** (v3.0.3) - PDF ç”Ÿæˆ
- **jsPDF-AutoTable** (v5.0.2) - PDF è¡¨æ ¼ç”Ÿæˆ
- **html2canvas** (v1.4.1) - HTML è½‰åœ–ç‰‡ï¼ˆç”¨æ–¼å–®ç·šåœ–å°å‡ºï¼‰

### ç‹€æ…‹ç®¡ç†
- **Vuex / Pinia** - æœªä½¿ç”¨
- ä½¿ç”¨ Vue 3 Composition API å’Œ Reactive æ•¸æ“š

### æ§‹å»ºå·¥å…·
- **Vite** - é–‹ç™¼æœå‹™å™¨å’Œæ‰“åŒ…å·¥å…·
- **@vitejs/plugin-vue** - Vue 3 æ’ä»¶

---

## ğŸ–¥ï¸ å¾Œç«¯æŠ€è¡“ç·š (Backend)

### é‹è¡Œç’°å¢ƒ
- **Node.js** - JavaScript é‹è¡Œç’°å¢ƒ
- **ES Modules** - ä½¿ç”¨ `"type": "module"`

### Web æ¡†æ¶
- **Express.js** (v4.18.2) - è¼•é‡ç´š Web æ¡†æ¶
  - RESTful API è¨­è¨ˆ
  - JSON è«‹æ±‚é«”æ”¯æŒ (æœ€å¤§ 25MB)
  - CORS è·¨åŸŸæ”¯æŒ

### ä¸­é–“ä»¶
- **CORS** (v2.8.5) - è·¨åŸŸè³‡æºå…±äº«
- **express.json()** - JSON è§£æä¸­é–“ä»¶

### æ•¸æ“šåº«
- **better-sqlite3** (v9.2.2) - SQLite3 çš„åŒæ­¥ Node.js ç¶å®š
  - é«˜æ€§èƒ½
  - åŒæ­¥ APIï¼ˆæ›´ç°¡å–®ï¼‰
  - æ”¯æŒæº–å‚™å¥½çš„èªå¥ï¼ˆPrepared Statementsï¼‰

### å¤–éƒ¨ä¾è³´
- **LibreOffice** - Excel è½‰ PDFï¼ˆé€šéå‘½ä»¤è¡Œèª¿ç”¨ sofficeï¼‰
  - éœ€è¦ç³»çµ±å®‰è£ LibreOffice
  - ä½¿ç”¨ `child_process.execFile` åŸ·è¡Œè½‰æ›

---

## ğŸ—„ï¸ è³‡æ–™åº«æ¶æ§‹ (Database)

### æ•¸æ“šåº«é¡å‹
- **SQLite 3** - åµŒå…¥å¼é—œè¯å¼æ•¸æ“šåº«

### è¡¨çµæ§‹

#### flowcharts è¡¨
```sql
CREATE TABLE flowcharts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  project_name TEXT NOT NULL UNIQUE,        -- å°ˆæ¡ˆåç¨±ï¼ˆå”¯ä¸€ï¼‰
  data TEXT NOT NULL,                       -- JSON æ ¼å¼çš„æµç¨‹åœ–æ•¸æ“š
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### è§¸ç™¼å™¨ (Triggers)
- **update_flowcharts_timestamp** - è‡ªå‹•æ›´æ–° `updated_at` æ™‚é–“æˆ³

### ç´¢å¼•ç­–ç•¥
- ä¸»éµç´¢å¼•ï¼š`id`
- å”¯ä¸€ç´¢å¼•ï¼š`project_name` (UNIQUE constraint)

---

## ğŸ”Œ API æ¶æ§‹ (RESTful API)

### Base URL
```
http://localhost:3001/api
```

### API ç«¯é»

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/flowcharts` | å–å¾—æ‰€æœ‰æª”æ¡ˆåˆ—è¡¨ |
| GET | `/api/flowcharts/search?q=keyword` | æœå°‹æª”æ¡ˆ |
| GET | `/api/flowcharts/:id` | å–å¾—å–®ä¸€æª”æ¡ˆ |
| POST | `/api/flowcharts` | å»ºç«‹æ–°æª”æ¡ˆ |
| PUT | `/api/flowcharts/:id` | æ›´æ–°æª”æ¡ˆ |
| DELETE | `/api/flowcharts/:id` | åˆªé™¤æª”æ¡ˆ |
| POST | `/api/export-flowchart/pdf` | Excel è½‰ PDF |

### æ•¸æ“šæ ¼å¼

#### å„²å­˜æ ¼å¼ï¼ˆdata æ¬„ä½ï¼‰
```json
{
  "allModuleSets": [...],
  "settings": {...},
  "pageBreaks": [...]
}
```

---

## ğŸ“¦ å°ˆæ¡ˆçµæ§‹

```
geniideas-vue/
â”œâ”€â”€ src/                          # å‰ç«¯æºç¢¼
â”‚   â”œâ”€â”€ App.vue                   # ä¸»æ‡‰ç”¨çµ„ä»¶ (13916 è¡Œï¼)
â”‚   â”œâ”€â”€ components/               # Vue çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ FlowCards/            # æµç¨‹å¡ç‰‡çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SourceInfoCard.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ValveInfoCard.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ PipelineInfoCard.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ FloorInfoCard.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ PanelInfoCard.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ EquipmentInfoCard.vue
â”‚   â”‚   â”‚   â””â”€â”€ BranchSourceInfoCard.vue
â”‚   â”‚   â”œâ”€â”€ ConnectionLine.vue    # é€£æ¥ç·šçµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ FileManager.vue       # æª”æ¡ˆç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ Setting.vue           # è¨­ç½®é¢æ¿
â”‚   â”‚   â””â”€â”€ Popup.vue             # å½ˆå‡ºçª—å£
â”‚   â”œâ”€â”€ assets/                   # éœæ…‹è³‡æº
â”‚   â”‚   â”œâ”€â”€ const/                # å¸¸é‡é…ç½®ï¼ˆJSONï¼‰
â”‚   â”‚   â”œâ”€â”€ images/               # åœ–ç‰‡è³‡æº
â”‚   â”‚   â”œâ”€â”€ styles/               # SCSS æ¨£å¼
â”‚   â”‚   â””â”€â”€ export/               # å°å‡ºç¯„æœ¬
â”‚   â””â”€â”€ utils/                    # å·¥å…·å‡½æ•¸
â”‚       â””â”€â”€ flowchartRenderer.js  # æµç¨‹åœ–æ¸²æŸ“å™¨
â”œâ”€â”€ server/                       # å¾Œç«¯æºç¢¼
â”‚   â”œâ”€â”€ index.js                  # Express ä¼ºæœå™¨
â”‚   â”œâ”€â”€ db/                       # è³‡æ–™åº«
â”‚   â”‚   â”œâ”€â”€ database.js           # è³‡æ–™åº«é€£æ¥
â”‚   â”‚   â”œâ”€â”€ schema.sql            # è³‡æ–™åº«çµæ§‹
â”‚   â”‚   â””â”€â”€ flowcharts.db         # SQLite æª”æ¡ˆ
â”‚   â””â”€â”€ package.json              # å¾Œç«¯ä¾è³´
â”œâ”€â”€ public/                       # éœæ…‹è³‡æº
â”œâ”€â”€ dist/                         # æ‰“åŒ…è¼¸å‡º
â”œâ”€â”€ package.json                  # å‰ç«¯ä¾è³´
â””â”€â”€ vite.config.js                # Vite é…ç½®
```

---

## ğŸ”„ æ•¸æ“šæµå‘

### 1. å„²å­˜æµç¨‹åœ–
```
ç”¨æˆ¶æ“ä½œ â†’ Vue çµ„ä»¶
    â†“
App.vue (allModuleSets)
    â†“
getCurrentData() æ–¹æ³•
    â†“
JSON.stringify()
    â†“
POST /api/flowcharts
    â†“
Express å¾Œç«¯
    â†“
SQLite INSERT
    â†“
è¿”å›æˆåŠŸéŸ¿æ‡‰
```

### 2. è®€å–æµç¨‹åœ–
```
ç”¨æˆ¶é»æ“Šè®€å– â†’ FileManager çµ„ä»¶
    â†“
GET /api/flowcharts/:id
    â†“
Express å¾Œç«¯
    â†“
SQLite SELECT
    â†“
è¿”å› JSON æ•¸æ“š
    â†“
executeLoad() æ–¹æ³•
    â†“
é‚„åŸ allModuleSets
    â†“
Vue éŸ¿æ‡‰å¼æ›´æ–° UI
```

### 3. å°å‡º PDF
```
ç”¨æˆ¶é»æ“Šå°å‡º â†’ flowchartRenderer.js
    â†“
ç”Ÿæˆ Excel (ExcelJS)
    â†“
Base64 ç·¨ç¢¼
    â†“
POST /api/export-flowchart/pdf
    â†“
å¾Œç«¯å¯«å…¥è‡¨æ™‚æª”æ¡ˆ
    â†“
åŸ·è¡Œ LibreOffice è½‰æ›
    â†“
è®€å– PDF
    â†“
è¿”å› PDF æª”æ¡ˆæµ
    â†“
ç€è¦½å™¨ä¸‹è¼‰
```

---

## ğŸš€ éƒ¨ç½²å»ºè­°

### é–‹ç™¼ç’°å¢ƒ
```bash
# å¾Œç«¯
cd server
npm install
npm run dev          # Port 3001

# å‰ç«¯
npm install
npm run dev          # Vite dev server
```

### ç”Ÿç”¢ç’°å¢ƒ
```bash
# å‰ç«¯æ‰“åŒ…
npm run build        # è¼¸å‡ºåˆ° dist/

# å¾Œç«¯
cd server
npm start            # Port 3001

# éœæ…‹æ–‡ä»¶æœå‹™
# ä½¿ç”¨ nginx/apache è¨—ç®¡ dist/ ç›®éŒ„
```

---

## ğŸ’¡ æŠ€è¡“ç‰¹è‰²

### å„ªé»
1. âœ… **è¼•é‡æ¶æ§‹** - SQLite åµŒå…¥å¼æ•¸æ“šåº«ï¼Œç„¡éœ€é¡å¤–æ•¸æ“šåº«æœå‹™
2. âœ… **é«˜æ€§èƒ½** - better-sqlite3 åŒæ­¥ APIï¼Œæ¸›å°‘ç•°æ­¥é–‹éŠ·
3. âœ… **ç°¡å–®éƒ¨ç½²** - å–®ä¸€ SQLite æª”æ¡ˆï¼Œæ˜“æ–¼å‚™ä»½å’Œé·ç§»
4. âœ… **ç¾ä»£åŒ–å‰ç«¯** - Vue 3 + Viteï¼Œé–‹ç™¼é«”é©—æ¥µä½³
5. âœ… **æ¨¡çµ„åŒ–è¨­è¨ˆ** - çµ„ä»¶åŒ–æ¶æ§‹ï¼Œæ˜“æ–¼ç¶­è­·

### å¯å„ªåŒ–æ–¹å‘
1. âš ï¸ **å¤§æ–‡ä»¶è™•ç†** - ç›®å‰é™åˆ¶ 25MBï¼Œå¯è€ƒæ…®åˆ†å¡Šä¸Šå‚³
2. âš ï¸ **ä¸¦ç™¼æ§åˆ¶** - SQLite å¯«å…¥ä½µç™¼èƒ½åŠ›æœ‰é™
3. âš ï¸ **é¡å‹å®‰å…¨** - å¯è€ƒæ…®å¼•å…¥ TypeScript
4. âš ï¸ **éŒ¯èª¤è™•ç†** - å¯åŠ å¼·å‰ç«¯éŒ¯èª¤é‚Šç•Œ
5. âš ï¸ **æ€§èƒ½ç›£æ§** - å¯åŠ å…¥ APM å·¥å…·

---

## ğŸ“š æŠ€è¡“é¸å‹åŸå› 

### ç‚ºä»€éº¼é¸æ“‡ SQLiteï¼Ÿ
- âœ… é©åˆä¸­å°å‹æ‡‰ç”¨
- âœ… é›¶é…ç½®ï¼Œé–‹ç®±å³ç”¨
- âœ… å–®æª”æ¡ˆï¼Œæ˜“æ–¼å‚™ä»½
- âœ… æ€§èƒ½å„ªç•°ï¼ˆè®€å–å¯†é›†å‹ï¼‰

### ç‚ºä»€éº¼é¸æ“‡ Expressï¼Ÿ
- âœ… è¼•é‡ç´šï¼Œå­¸ç¿’æ›²ç·šå¹³ç·©
- âœ… ç”Ÿæ…‹è±å¯Œ
- âœ… é©åˆ RESTful API

### ç‚ºä»€éº¼é¸æ“‡ Vue 3ï¼Ÿ
- âœ… æ¼¸é€²å¼æ¡†æ¶ï¼Œéˆæ´»åº¦é«˜
- âœ… Composition API æ›´å¥½çš„ä»£ç¢¼çµ„ç¹”
- âœ… éŸ¿æ‡‰å¼ç³»çµ±æ€§èƒ½å„ªç•°
- âœ… ç”Ÿæ…‹æˆç†Ÿ

---

## ğŸ” å®‰å…¨è€ƒé‡

### ç¾æœ‰æ©Ÿåˆ¶
- âœ… CORS é…ç½®
- âœ… JSON å¤§å°é™åˆ¶ (25MB)
- âœ… SQLite åƒæ•¸åŒ–æŸ¥è©¢ï¼ˆé˜² SQL æ³¨å…¥ï¼‰
- âœ… æ–‡ä»¶åæ¸…ç†ï¼ˆé˜²è·¯å¾‘éæ­·ï¼‰

### å»ºè­°åŠ å¼·
- âš ï¸ æ·»åŠ èº«ä»½é©—è­‰ (JWT/Session)
- âš ï¸ è¼¸å…¥é©—è­‰å’Œæ¶ˆæ¯’
- âš ï¸ è«‹æ±‚é »ç‡é™åˆ¶
- âš ï¸ HTTPS éƒ¨ç½²

---

## ğŸ“Š æ€§èƒ½æŒ‡æ¨™

### æ•¸æ“šåº«
- å–®æ¬¡æŸ¥è©¢ï¼š< 10ms
- å¯«å…¥æ“ä½œï¼š< 50ms
- æ•¸æ“šåº«å¤§å°ï¼šå–æ±ºæ–¼æµç¨‹åœ–æ•¸é‡

### API
- å¹³å‡éŸ¿æ‡‰æ™‚é–“ï¼š50-200ms
- PDF è½‰æ›ï¼š2-5ç§’ï¼ˆå–æ±ºæ–¼è¤‡é›œåº¦ï¼‰

### å‰ç«¯
- åˆå§‹è¼‰å…¥ï¼š< 2s
- äº¤äº’éŸ¿æ‡‰ï¼š< 100ms
- å¤§å‹æµç¨‹åœ–ï¼ˆ100+ å¡ç‰‡ï¼‰ï¼šä»ç„¶æµæš¢

---

## ğŸ¯ ç¸½çµ

é€™æ˜¯ä¸€å€‹**è¼•é‡ç´šã€ç¾ä»£åŒ–çš„å…¨ç«¯æ‡‰ç”¨**ï¼š

- **å‰ç«¯**ï¼šVue 3 + Vite + SCSS
- **å¾Œç«¯**ï¼šNode.js + Express + SQLite
- **ç‰¹è‰²**ï¼šåµŒå…¥å¼æ•¸æ“šåº«ã€RESTful APIã€æ¨¡çµ„åŒ–è¨­è¨ˆ
- **é©ç”¨å ´æ™¯**ï¼šä¸­å°å‹ä¼æ¥­å…§éƒ¨å·¥å…·ã€å–®ç”¨æˆ¶/å°åœ˜éšŠå”ä½œ

æŠ€è¡“æ£§ç°¡å–®ä½†åŠŸèƒ½å®Œæ•´ï¼Œæ˜“æ–¼éƒ¨ç½²å’Œç¶­è­·ï¼

